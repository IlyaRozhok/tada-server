# –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

–£–±—Ä–∞–ª–∏ —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π –∏ —Å–¥–µ–ª–∞–ª–∏ –ø—Ä–æ—Å—Ç—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é:

1. **–£–±—Ä–∞–ª–∏ RolesGuard** - –±–æ–ª—å—à–µ –Ω–µ—Ç —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ —Ä–æ–ª–µ–π
2. **–£–ø—Ä–æ—Å—Ç–∏–ª–∏ JWT Strategy** - —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞
3. **–î–æ–±–∞–≤–∏–ª–∏ –ø—Ä–æ—Å—Ç—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
4. **–£–ø—Ä–æ—Å—Ç–∏–ª–∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã** - tenant ‚Üí `/dashboard/tenant`, operator ‚Üí `/dashboard/operator`

## –ù–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### `/api/auth/dashboard-info`
–ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏ –∫—É–¥–∞ –µ–≥–æ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç—å:

```json
{
  "success": true,
  "user": {
    "id": "user-id",
    "email": "user@example.com",
    "role": "tenant"
  },
  "dashboard": "/dashboard/tenant",
  "message": "User is tenant, redirect to /dashboard/tenant"
}
```

### `/api/operator/dashboard`
–¢–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –ª—é–±–æ–≥–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–µ —Ç–æ–ª—å–∫–æ operator).

## –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞

```javascript
// –§—Ä–æ–Ω—Ç–µ–Ω–¥ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:
const response = await fetch('/api/auth/dashboard-info', {
  headers: {
    'Authorization': `Bearer ${token}`
  }
});

const data = await response.json();
if (data.success) {
  // –ü—Ä–æ—Å—Ç–æ–π —Ä–µ–¥–∏—Ä–µ–∫—Ç
  window.location.href = data.dashboard;
}
```

## –ß—Ç–æ —É–±—Ä–∞–ª–∏

1. ‚ùå –°–ª–æ–∂–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π –≤ RolesGuard
2. ‚ùå –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ guards
3. ‚ùå –°–ª–æ–∂–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. ‚ùå –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º –ø–æ —Ä–æ–ª—è–º

## –ß—Ç–æ –æ—Å—Ç–∞–≤–∏–ª–∏

1. ‚úÖ –ë–∞–∑–æ–≤–∞—è JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
2. ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
3. ‚úÖ –ë–∞–∑–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
4. ‚úÖ –ü—Ä–æ—Å—Ç—ã–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã –ø–æ —Ä–æ–ª—è–º

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –¢–µ—Å—Ç —É–ø—Ä–æ—â–µ–Ω–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
npm run test:simple

# –¢–µ—Å—Ç JWT
npm run test:jwt:simple

# –¢–µ—Å—Ç –ø–æ–ª–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
npm run test:auth
```

## –§—Ä–æ–Ω—Ç–µ–Ω–¥ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### 1. –ü–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏/–≤—Ö–æ–¥–∞
```javascript
// –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω
localStorage.setItem('access_token', response.data.access_token);

// –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–∞—à–±–æ—Ä–¥–µ
const dashboardInfo = await fetch('/api/auth/dashboard-info', {
  headers: {
    'Authorization': `Bearer ${response.data.access_token}`
  }
});

const info = await dashboardInfo.json();
// –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –¥–∞—à–±–æ—Ä–¥
window.location.href = info.dashboard;
```

### 2. –î–ª—è –≤—Å–µ—Ö –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
```javascript
const token = localStorage.getItem('access_token');
const headers = {
  'Authorization': `Bearer ${token}`,
  'Content-Type': 'application/json'
};

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö
fetch('/api/operator/dashboard', { headers });
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —É–ø—Ä–æ—â–µ–Ω–∏—è

1. üöÄ **–ë—ã—Å—Ç—Ä–µ–µ** - –º–µ–Ω—å—à–µ –ø—Ä–æ–≤–µ—Ä–æ–∫
2. üîß **–ü—Ä–æ—â–µ** - –ª–µ–≥—á–µ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å
3. üì± **–ù–∞–¥–µ–∂–Ω–µ–µ** - –º–µ–Ω—å—à–µ —Ç–æ—á–µ–∫ –æ—Ç–∫–∞–∑–∞
4. üéØ **–ü–æ–Ω—è—Ç–Ω–µ–µ** - –ø—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ë–∞–∑–æ–≤–∞—è JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- –¢–æ–∫–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –Ω–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã
- –†–æ–ª–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç —Ç–æ–ª—å–∫–æ —Ä–µ–¥–∏—Ä–µ–∫—Ç, –Ω–µ –¥–æ—Å—Ç—É–ø

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —É–ø—Ä–æ—â–µ–Ω–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
2. üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
3. üîÑ –£–±—Ä–∞—Ç—å —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
4. üîÑ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π flow —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞
